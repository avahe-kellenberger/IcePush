{"code":"!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=16)}([function(t,e,n){\"use strict\";var r=n(3),i=n(5),s=n(1);class o extends s.a{constructor(t){super(),this.playerID=t.readInt16BE(),this.type=t.readInt8(),this.username=t.readString(),this.lives=t.readUInt8(),this.BINARY_SIZE=4+r.a.getStringWriteSize(this.username)}getEventSize(){return this.BINARY_SIZE}getOPCode(){return v.NEW_PLAYER}write(t){}}var a=n(2);class h extends s.a{constructor(t){super(),this.id=t.readInt16BE(),this.location=new a.a(t.readInt16BE(),t.readInt16BE())}getEventSize(){return h.BINARY_SIZE}getOPCode(){return v.OBJECT_MOVED}write(t){t.writeInt16BE(this.id),t.writeInt16BE(this.location.x),t.writeInt16BE(this.location.y)}}h.BINARY_SIZE=6;var u=n(6);class c extends s.a{constructor(t,e){if(super(),t instanceof r.a)this.timeMilliseconds=t.readUInt16BE();else{if(void 0===e)throw new Error(`Malformed constructor:\\n${t}`);this.timeMilliseconds=e}}getEventSize(){return c.BINARY_SIZE}getOPCode(){return v.ROUND_STARTED}write(t){t.writeUInt16BE(this.timeMilliseconds)}}c.BINARY_SIZE=2;var l=n(7),d=n(8);class f extends s.a{constructor(t){super(),this.playerID=\"number\"==typeof t?t:t.readInt16BE()}getEventSize(){return f.BINARY_SIZE}getOPCode(){return v.PLAYER_LOGGED_OUT}write(t){t.writeInt16BE(this.playerID)}}f.BINARY_SIZE=2;class g extends s.a{constructor(t,e){if(super(),t instanceof r.a)this.playerID=t.readUInt16BE(),this.lives=t.readUInt8();else{if(void 0===e)throw new Error(`Malformed constructor:\\n${t}\\n${e}`);this.playerID=t,this.lives=e}}getEventSize(){return g.BINARY_SIZE}getOPCode(){return v.PLAYER_LIVES_CHANGED}write(t){t.writeUInt16BE(this.playerID),t.writeUInt8(this.lives)}}g.BINARY_SIZE=3;class p extends s.a{constructor(t){if(super(),t instanceof r.a){const e=t.readUInt8();this.winnerIDs=new Array(e);for(let n=0;n<e;n++)this.winnerIDs.push(t.readUInt8())}else this.winnerIDs=t;this.BINARY_SIZE=1+this.winnerIDs.length}getEventSize(){return this.BINARY_SIZE}getOPCode(){return v.ROUND_WINNERS}write(t){t.writeUInt8(this.winnerIDs.length);for(const e of this.winnerIDs)t.writeUInt8(e)}}class E extends c{getOPCode(){return v.ROUND_START_COUNTDOWN}}class y extends s.a{constructor(t,e,n){if(super(),t instanceof r.a)this.id=t.readInt16BE(),this.type=t.readInt8(),this.location=new a.a(t.readInt16BE(),t.readInt16BE());else{if(void 0===e||void 0===n)throw new Error(`Malformed constructor:\\n${t}\\n${n}\\n${n}`);this.id=t,this.type=e,this.location=n}}getEventSize(){return y.BINARY_SIZE}getOPCode(){return v.NEW_OBJECT}write(t){t.writeInt16BE(this.id),t.writeInt8(this.type),t.writeInt16BE(this.location.x),t.writeInt16BE(this.location.y)}}y.BINARY_SIZE=7;var v,m=n(9);n.d(e,\"b\",function(){return v}),n.d(e,\"a\",function(){return w}),function(t){t[t.PING=-37]=\"PING\",t[t.LOGIN=0]=\"LOGIN\",t[t.FAILURE=1]=\"FAILURE\",t[t.SUCCESS=2]=\"SUCCESS\",t[t.NEW_OBJECT=3]=\"NEW_OBJECT\",t[t.NEW_PLAYER=5]=\"NEW_PLAYER\",t[t.OBJECT_MOVED=6]=\"OBJECT_MOVED\",t[t.MOVE_REQUEST=8]=\"MOVE_REQUEST\",t[t.END_MOVE=9]=\"END_MOVE\",t[t.LOGOUT=10]=\"LOGOUT\",t[t.PLAYER_LOGGED_OUT=11]=\"PLAYER_LOGGED_OUT\",t[t.PLAYER_LIVES_CHANGED=12]=\"PLAYER_LIVES_CHANGED\",t[t.PROJECTILE_REQUEST=15]=\"PROJECTILE_REQUEST\",t[t.CHAT_SEND=16]=\"CHAT_SEND\",t[t.CHAT_RECEIVED=17]=\"CHAT_RECEIVED\",t[t.ROUND_WINNERS=20]=\"ROUND_WINNERS\",t[t.ROUND_STARTED=21]=\"ROUND_STARTED\",t[t.ROUND_START_COUNTDOWN=22]=\"ROUND_START_COUNTDOWN\"}(v||(v={}));class w extends r.a{getEvents(){return void 0===this.events&&(this.events=this.readEvents()),this.events}readEvents(){const t=[];for(;this.isBufferValid();){const e=this.readInt8();t.push(this.readEvent(e))}return t}isBufferValid(){const t=this.getLength();if(t<3||this.getPosition()>=t-1)return!1;const e=this.readInt16BE();return!(e<0)&&this.getPosition()+e-2<=this.getLength()}readEvent(t){void 0===w.opcodeEventMap&&(w.opcodeEventMap=new Map([[v.PING,i.a],[v.FAILURE,l.a],[v.SUCCESS,d.a],[v.NEW_OBJECT,y],[v.NEW_PLAYER,o],[v.OBJECT_MOVED,h],[v.PLAYER_LOGGED_OUT,f],[v.PLAYER_LIVES_CHANGED,g],[v.PROJECTILE_REQUEST,m.a],[v.CHAT_RECEIVED,u.a],[v.ROUND_WINNERS,p],[v.ROUND_STARTED,c],[v.ROUND_START_COUNTDOWN,E]]));const e=w.opcodeEventMap.get(t);if(void 0===e)throw new Error(`Unsupported event type!\\nOPCode: ${t}`);return new e(this)}}},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return r});class r{constructor(t){}}},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return r});class r{constructor(t,e){this.x=t,this.y=e}getMagnitude(){return Math.sqrt(this.getMagnitudeSquared())}getMagnitudeSquared(){return this.x*this.x+this.y*this.y}addVector(t){return this.add(t.x,t.y)}add(t,e){return new r(this.x+t,this.y+e)}subtractVector(t){return this.subtract(t.x,t.y)}subtract(t,e){return new r(this.x-t,this.y-e)}multiplyScalar(t){return new r(this.x*t,this.y*t)}dotProduct(t){return this.x*t.x+this.y*t.y}crossProduct(t){return this.x*t.y-t.x*this.y}reflect(t){let e=2*this.dotProduct(t);return this.subtractVector(t.multiplyScalar(e))}negate(){return new r(-this.x,-this.y)}inverse(){return new r(1/this.x,1/this.y)}round(){return new r(Math.round(this.x),Math.round(this.y))}abs(){return new r(Math.abs(this.x),Math.abs(this.y))}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}getPerpendicular(){return new r(-this.y,this.x)}normalize(t=1){const e=t/this.getMagnitude();return new r(this.x*e,this.y*e)}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}getAngle(){return Math.atan2(this.y,this.x)}toString(){return\"(\"+this.x+\",\"+this.y+\")\"}equals(t){return this.x===t.x&&this.y===t.y}}r.ZERO=new r(0,0),r.ONE=new r(1,1)},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return r});class r{constructor(t,e){this.buffer=t,this.pos=i.create(e)}getPosition(){return this.pos()}setPosition(t){this.pos(t,!0)}getLength(){return this.buffer.byteLength}getBuffer(){return this.buffer}readString(){const t=this.readInt16BE();return this.buffer.toString(r.STRING_ENCODING,this.pos(t),this.pos())}writeString(t){this.writeInt16BE(t.length);for(let e=0;e<t.length;e++)this.writeInt8(t.charCodeAt(e));return this.pos()}readInt8(){return this.buffer.readInt8(this.pos(1))}readUInt8(){return this.buffer.readUInt8(this.pos(1))}writeInt8(t){return this.buffer.writeInt8(t,this.pos(1))}writeUInt8(t){return this.buffer.writeUInt8(t,this.pos(1))}readInt16BE(){return(255&this.readInt8())+(this.readInt8()<<8)}writeInt16BE(t){return this.writeUInt8(255&t),this.writeUInt8(t>>8&255)}readUInt16BE(){return(255&this.readUInt8())+(this.readUInt8()<<8)}writeUInt16BE(t){return this.writeUInt8(t),this.writeUInt8(t>>8)}readInt32BE(){return(255&this.readInt8())+((255&this.readInt8())<<8)+((255&this.readInt8())<<16)+((255&this.readInt8())<<24)}writeInt32BE(t){return this.writeInt8(255&t),this.writeInt8(t>>8),this.writeInt8(t>>16),this.writeInt8(t>>24)}static getStringWriteSize(t){return t.length+2}}var i;r.STRING_ENCODING=\"utf8\",function(t){t.create=function(t=0){return(e,n)=>{const r=t;return null!=e&&(t=n?e:t+e),r}}}(i||(i={}))},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return i});const r=.001;class i{static now(){return i.msToSeconds(i.nowMilliseconds())}static nowMilliseconds(){return performance.now()}static msToSeconds(t){return t*r}}},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return s});var r=n(1),i=n(0);class s extends r.a{getEventSize(){return s.BINARY_SIZE}getOPCode(){return i.b.PING}write(t){}}s.BINARY_SIZE=0},function(t,e,n){\"use strict\";n.d(e,\"b\",function(){return a}),n.d(e,\"a\",function(){return h});var r=n(1),i=n(3),s=n(0);class o extends r.a{constructor(t){super(),this.chatMessage=\"string\"==typeof t?t:t.readString(),this.BINARY_SIZE=i.a.getStringWriteSize(this.chatMessage)}write(t){t.writeString(this.chatMessage)}getEventSize(){return this.BINARY_SIZE}}class a extends o{getOPCode(){return s.b.CHAT_SEND}}class h extends o{getOPCode(){return s.b.CHAT_RECEIVED}}},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return o});var r=n(1),i=n(3),s=n(0);class o extends r.a{constructor(t){super(),this.message=\"string\"==typeof t?t:t.readString(),this.BINARY_SIZE=i.a.getStringWriteSize(this.message)}getEventSize(){return this.BINARY_SIZE}getOPCode(){return s.b.FAILURE}write(t){t.writeString(this.message)}}},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return s});var r=n(1),i=n(0);class s extends r.a{constructor(t){super(),this.playerID=\"number\"==typeof t?t:t.readUInt8()}getEventSize(){return s.BINARY_SIZE}getOPCode(){return i.b.SUCCESS}write(t){t.writeUInt8(this.playerID)}}s.BINARY_SIZE=1},function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return o});var r=n(1),i=n(3),s=n(0);class o extends r.a{constructor(t,e){if(super(),this.BINARY_SIZE=4,t instanceof i.a)this.x=t.readInt16BE(),this.y=t.readInt16BE();else{if(void 0===e)throw new Error(`Malformed constructor:\\n${t}\\n${e}`);this.x=Math.round(t),this.y=Math.round(e)}}write(t){t.writeInt16BE(this.x),t.writeInt16BE(this.y)}getOPCode(){return s.b.PROJECTILE_REQUEST}getEventSize(){return this.BINARY_SIZE}}},function(t,e,n){\"use strict\";(function(t){n.d(e,\"a\",function(){return s});var r=n(4),i=n(0);class s{constructor(t,e){this.socket=new WebSocket(t,e),this.dataListeners=[],this.eventQueue=[],this.socket.binaryType=\"arraybuffer\",this.addMessageListener(t=>{if(!(t.data instanceof ArrayBuffer))throw new Error(\"Unsupported WebSocket data type: \"+typeof t.data);this.onReceived(t.data)}),this.addErrorListener(this.onError),this.addCloseListener(this.onClose),this.lastSendTime=-1}addOnOpenedListener(t){this.socket.addEventListener(\"open\",t)}removeOnOpenedListener(t){this.socket.removeEventListener(\"open\",t)}addCloseListener(t){this.socket.addEventListener(\"close\",t)}removeCloseListener(t){this.socket.removeEventListener(\"close\",t)}addMessageListener(t){this.socket.addEventListener(\"message\",t)}removeMessageListener(t){this.socket.removeEventListener(\"message\",t)}addErrorListener(t){this.socket.addEventListener(\"error\",t)}removeErrorListener(t){this.socket.removeEventListener(\"error\",t)}addDataReceivedListener(t){this.dataListeners.push(t)}removeDataReceivedListener(t){const e=this.dataListeners.indexOf(t);e>=0&&this.dataListeners.splice(e,1)}onReceived(e){this.dataListeners.forEach(n=>{n(new i.a(new t(e.slice(0))))})}onClose(t){console.error(`Connection closed with code ${t.code}`),t.reason.length>0&&console.error(`Reason: ${t.reason}`)}onError(t){console.error(`Connection Error: ${t}`)}enqueueEvent(t){this.eventQueue.push(t)}flushEventQueue(){this.sendEvents(this.eventQueue),this.eventQueue.length=0}send(t){this.sendBuffer(this.createEventBuffer(t).getBuffer())}sendEvents(e){const n=[];e.forEach(t=>n.push(this.createEventBuffer(t).getBuffer())),this.sendBuffer(t.concat(n))}createEventBuffer(e){const n=3+e.getEventSize(),r=new i.a(new t(n));return r.writeInt16BE(e.getEventSize()+1),r.writeInt8(e.getOPCode()),e.write(r),r}sendBuffer(t){this.socket.send(t),this.lastSendTime=r.a.now()}isConnected(){return this.socket.readyState===WebSocket.OPEN}getState(){return this.socket.readyState}getLastSendTime(){return this.lastSendTime}close(t){null==t?t=1e3:\"boolean\"==typeof t&&(t=t?4e3:1e3),this.socket.close(t)}}}).call(this,n(11).Buffer)},function(t,e,n){\"use strict\";(function(t){\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nvar r=n(13),i=n(14),s=n(15);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError(\"Invalid typed array length\");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,n){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,n);if(\"number\"==typeof t){if(\"string\"==typeof e)throw new Error(\"If encoding is specified then the first argument must be a string\");return l(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if(\"number\"==typeof e)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError(\"'offset' is out of bounds\");if(e.byteLength<n+(r||0))throw new RangeError(\"'length' is out of bounds\");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=d(t,e);return t}(t,e,n,r):\"string\"==typeof e?function(t,e,n){\"string\"==typeof n&&\"\"!==n||(n=\"utf8\");if(!h.isEncoding(n))throw new TypeError('\"encoding\" must be a valid string encoding');var r=0|g(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(h.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if(\"undefined\"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||\"length\"in e)return\"number\"!=typeof e.length||(r=e.length)!=r?a(t,0):d(t,e);if(\"Buffer\"===e.type&&s(e.data))return d(t,e.data)}var r;throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(t,e)}function c(t){if(\"number\"!=typeof t)throw new TypeError('\"size\" argument must be a number');if(t<0)throw new RangeError('\"size\" argument must not be negative')}function l(t,e){if(c(e),t=a(t,e<0?0:0|f(e)),!h.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=o())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+o().toString(16)+\" bytes\");return 0|t}function g(t,e){if(h.isBuffer(t))return t.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;\"string\"!=typeof t&&(t=\"\"+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case\"ascii\":case\"latin1\":case\"binary\":return n;case\"utf8\":case\"utf-8\":case void 0:return H(t).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*n;case\"hex\":return n>>>1;case\"base64\":return G(t).length;default:if(r)return H(t).length;e=(\"\"+e).toLowerCase(),r=!0}}function p(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function E(t,e,n,r,i){if(0===t.length)return-1;if(\"string\"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if(\"string\"==typeof e&&(e=h.from(e,r)),h.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if(\"number\"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError(\"val must be string, number or Buffer\")}function y(t,e,n,r,i){var s,o=1,a=t.length,h=e.length;if(void 0!==r&&(\"ucs2\"===(r=String(r).toLowerCase())||\"ucs-2\"===r||\"utf16le\"===r||\"utf-16le\"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var c=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var l=!0,d=0;d<h;d++)if(u(t,s+d)!==u(e,d)){l=!1;break}if(l)return s}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError(\"Invalid hex string\");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function m(t,e,n,r){return z(H(e,t.length-n),t,n,r)}function w(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function I(t,e,n,r){return w(t,e,n,r)}function R(t,e,n,r){return z(G(e),t,n,r)}function S(t,e,n,r){return z(function(t,e){for(var n,r,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(e,t.length-n),t,n,r)}function L(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function b(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,h,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[i+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,l=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=l}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var n=\"\",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.Buffer=h,e.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&\"function\"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,n){return u(null,t,e,n)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?a(t,e):void 0!==n?\"string\"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},h.allocUnsafe=function(t){return l(null,t)},h.allocUnsafeSlow=function(t){return l(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError(\"Arguments must be Buffers\");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},h.concat=function(t,e){if(!s(t))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=h.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!h.isBuffer(o))throw new TypeError('\"list\" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},h.byteLength=g,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?\"\":0===arguments.length?b(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return\"\";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return\"\";if((n>>>=0)<=(e>>>=0))return\"\";for(t||(t=\"utf8\");;)switch(t){case\"hex\":return C(this,e,n);case\"utf8\":case\"utf-8\":return b(this,e,n);case\"ascii\":return _(this,e,n);case\"latin1\":case\"binary\":return O(this,e,n);case\"base64\":return L(this,e,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return T(this,e,n);default:if(r)throw new TypeError(\"Unknown encoding: \"+t);t=(t+\"\").toLowerCase(),r=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError(\"Argument must be a Buffer\");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t=\"\",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString(\"hex\",0,n).match(/.{2}/g).join(\" \"),this.length>n&&(t+=\" ... \")),\"<Buffer \"+t+\">\"},h.prototype.compare=function(t,e,n,r,i){if(!h.isBuffer(t))throw new TypeError(\"Argument must be a Buffer\");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError(\"out of range index\");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(r,i),c=t.slice(e,n),l=0;l<a;++l)if(u[l]!==c[l]){s=u[l],o=c[l];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},h.prototype.indexOf=function(t,e,n){return E(this,t,e,n,!0)},h.prototype.lastIndexOf=function(t,e,n){return E(this,t,e,n,!1)},h.prototype.write=function(t,e,n,r){if(void 0===e)r=\"utf8\",n=this.length,e=0;else if(void 0===n&&\"string\"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");e|=0,isFinite(n)?(n|=0,void 0===r&&(r=\"utf8\")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");r||(r=\"utf8\");for(var s=!1;;)switch(r){case\"hex\":return v(this,t,e,n);case\"utf8\":case\"utf-8\":return m(this,t,e,n);case\"ascii\":return w(this,t,e,n);case\"latin1\":case\"binary\":return I(this,t,e,n);case\"base64\":return R(this,t,e,n);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return S(this,t,e,n);default:if(s)throw new TypeError(\"Unknown encoding: \"+r);r=(\"\"+r).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function _(t,e,n){var r=\"\";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function O(t,e,n){var r=\"\";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function C(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i=\"\",s=e;s<n;++s)i+=k(t[s]);return i}function T(t,e,n){for(var r=t.slice(e,n),i=\"\",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function x(t,e,n){if(t%1!=0||t<0)throw new RangeError(\"offset is not uint\");if(t+e>n)throw new RangeError(\"Trying to access beyond buffer length\")}function B(t,e,n,r,i,s){if(!h.isBuffer(t))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('\"value\" argument is out of bounds');if(n+r>t.length)throw new RangeError(\"Index out of range\")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError(\"Index out of range\");if(n<0)throw new RangeError(\"Index out of range\")}function P(t,e,n,r,s){return s||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,s){return s||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}h.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=h.prototype;else{var i=e-t;n=new h(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},h.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},h.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},h.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},h.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||x(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},h.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},h.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},h.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},h.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},h.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},h.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},h.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},h.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError(\"targetStart out of bounds\");if(n<0||n>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(r<0)throw new RangeError(\"sourceEnd out of bounds\");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!h.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},h.prototype.fill=function(t,e,n,r){if(\"string\"==typeof t){if(\"string\"==typeof e?(r=e,e=0,n=this.length):\"string\"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&\"string\"!=typeof r)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof r&&!h.isEncoding(r))throw new TypeError(\"Unknown encoding: \"+r)}else\"number\"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError(\"Out of range index\");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),\"number\"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=h.isBuffer(t)?t:H(new h(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var Y=/[^+\\/0-9A-Za-z-_]/g;function k(t){return t<16?\"0\"+t.toString(16):t.toString(16)}function H(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error(\"Invalid code point\");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function G(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\\s+|\\s+$/g,\"\")}(t).replace(Y,\"\")).length<2)return\"\";for(;t.length%4!=0;)t+=\"=\";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(12))},function(t,e){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(n=window)}t.exports=n},function(t,e,n){\"use strict\";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],o=n[1],a=new s(function(t,e,n){return 3*(e+n)/4-n}(0,r,o)),h=0,c=o>0?r-4:r,l=0;l<c;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;2===o&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,a[h++]=255&e);1===o&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(c(t,o,o+16383>a?a:o+16383));1===i?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+\"==\")):2===i&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+\"=\"));return s.join(\"\")};for(var r=[],i=[],s=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",a=0,h=o.length;a<h;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error(\"Invalid string. Length must be a multiple of 4\");var n=t.indexOf(\"=\");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var i,s,o=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join(\"\")}i[\"-\".charCodeAt(0)]=62,i[\"_\".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var s,o,a=8*i-r-1,h=(1<<a)-1,u=h>>1,c=-7,l=n?i-1:0,d=n?-1:1,f=t[e+l];for(l+=d,s=f&(1<<-c)-1,f>>=-c,c+=a;c>0;s=256*s+t[e+l],l+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+t[e+l],l+=d,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=u}return(f?-1:1)*o*Math.pow(2,s-r)},e.write=function(t,e,n,r,i,s){var o,a,h,u=8*s-i-1,c=(1<<u)-1,l=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,g=r?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+l>=1?d/h:d*Math.pow(2,1-l))*h>=2&&(o++,h/=2),o+l>=c?(a=0,o=c):o+l>=1?(a=(e*h-1)*Math.pow(2,i),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&a,f+=g,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[n+f]=255&o,f+=g,o/=256,u-=8);t[n+f-g]|=128*p}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return\"[object Array]\"==n.call(t)}},function(t,e,n){\"use strict\";n.r(e);class r{}r.IMAGE_DIR=\"../resources/images/\",r.IMAGE_BACKGROUND=r.IMAGE_DIR+\"icepush.png\",r.IMAGE_SNOWMAN=r.IMAGE_DIR+\"snowman.png\",r.IMAGE_TREE=r.IMAGE_DIR+\"tree.png\",r.IMAGE_PRESENT=r.IMAGE_DIR+\"present.png\";class i{static getContext(t){const e=t.getContext(\"2d\");if(null==e)throw new Error(\"Unable to get context from canvas.\");return e}static create(t,e,n){const r=document.createElement(\"canvas\");return r.width=t,r.height=e,null!=n&&n(this.getContext(r)),r}static imageToCanvas(t){return this.create(this.toPixels(t.width),this.toPixels(t.height),e=>e.drawImage(t,0,0))}static toPixels(t){return\"number\"==typeof t?t:t.animVal.value}static stringToCanvas(t,e,n,r){const s=document.createElement(\"canvas\"),o=this.getContext(s);o.font=e;const a=2*o.measureText(t).width,h=2*parseInt(e);return s.width=a,s.height=h,o.font=e,o.textAlign=\"center\",o.textBaseline=\"middle\",null!=n&&(o.fillStyle=n,o.fillText(t,.5*a,.5*h)),null!=r&&(o.strokeStyle=r,o.strokeText(t,.5*a,.5*h)),i.trimTransparentPixels(s)}static fillTextMultiline(t,e,n,r,i){const s=t.textAlign,o=t.textBaseline;t.textAlign=\"center\",t.textBaseline=\"middle\";const a=e.split(\"\\n\"),h=1.2*i;for(const e of a)t.fillText(e,n,r),r+=h;t.textAlign=s,t.textBaseline=o}static trimTransparentPixels(t){const e=this.getContext(t),n=t.width,r=t.height,s=e.getImageData(0,0,n,r).data,o=4*n;let a=0,h=0,u=n,c=r;t:{e:{for(let t=3;h<r;h++){const e=t+o;for(let n=t;n<e;n+=4)if(0!=s[n])break e;t=e}a=0,u=0,h=0,c=0;break t}e:for(let t=r*o-1;c>=0;c--){const e=t-o;for(let n=t;n>e;n-=4)if(0!=s[n])break e;t=e}const t=(c-h)*o;e:for(let e=h*o+3;a<n;e+=4,a++){const n=e+t;for(let t=e;t<n;t+=o)if(0!=s[t])break e}e:for(let e=(h+1)*o-1;u>=0;e-=4,u--){const n=e+t;for(let t=e;t<n;t+=o)if(0!=s[t])break e}}return i.getSubCanvas(t,a,h,u-a,c-h)}static getSubCanvas(t,e,n,r,i){return this.create(r,i,s=>{s.drawImage(t,e,n,r,i,0,0,r,i)})}}class s{static load(){const t=[];return t.push(this.loadImage(r.IMAGE_BACKGROUND).then(t=>s.IMAGE_BACKGROUND=i.imageToCanvas(t))),t.push(this.loadImage(r.IMAGE_SNOWMAN).then(t=>s.IMAGE_SNOWMAN=i.imageToCanvas(t))),t.push(this.loadImage(r.IMAGE_TREE).then(t=>s.IMAGE_TREE=i.imageToCanvas(t))),t.push(this.loadImage(r.IMAGE_PRESENT).then(t=>s.IMAGE_PRESENT=i.imageToCanvas(t))),Promise.all(t).then()}static loadImage(t){return new Promise((e,n)=>{const r=new Image;r.onload=(()=>{e(r)}),r.onerror=(t=>{n(t)}),r.src=t})}static getImageByID(t){switch(t){case 0:return this.IMAGE_TREE;case 1:return this.IMAGE_SNOWMAN;case 2:return this.IMAGE_PRESENT}return s.IMAGE_BACKGROUND}}var o=n(4);class a{constructor(t){this.game=t,this.stopped=!0}loop(){if(this.stopped)return null;void 0===this.lastTick&&(this.lastTick=o.a.nowMilliseconds());const t=o.a.nowMilliseconds(),e=t-this.lastTick;this.game.update(e/1e3),this.game.render(),this.lastTick=t;const n=Math.max(0,a.FRAME_DELAY-e);return setTimeout(this.loop.bind(this),n)}start(){return!!this.stopped&&(this.stopped=!1,this.loop(),!0)}stop(){return!this.stopped&&(this.stopped=!0,!0)}}a.FPS=60,a.FRAME_DELAY=1e3/a.FPS;var h=n(2);class u{constructor(t,e){this.type=t,this.listener=e}}class c{constructor(t,e,n=!1){this.callback=t,this.filter=e,this.notifyAll=n}}class l{constructor(t){this.document=t,this.keyMap=new Map,this.keyHandlers=new Set,this.document.addEventListener(\"keydown\",t=>{const e=!this.isKeyDown(t.key);this.keyMap.set(t.key,!0),this.notifyKeyHandlers(t.key,!0,e)}),this.document.addEventListener(\"keyup\",t=>{const e=this.isKeyDown(t.key);this.keyMap.set(t.key,!1),this.notifyKeyHandlers(t.key,!1,e)}),this.document.addEventListener(\"blur\",()=>{this.keyMap.forEach((t,e)=>{this.keyMap.set(e,!1)})})}addEventHandler(t){this.document.addEventListener(t.type,t.listener)}removeEventHandler(t){this.document.removeEventListener(t.type,t.listener)}notifyKeyHandlers(t,e,n){this.keyHandlers.forEach(r=>{(void 0===r.filter||r.filter(t,e))&&(r.notifyAll||n)&&r.callback(t,e)})}isKeyDown(t){const e=this.keyMap.get(t);return void 0!==e&&e}addKeyHandler(t){return this.keyHandlers.size!==this.keyHandlers.add(t).size}removeKeyHandler(t){return void 0===this.keyHandlers||this.keyHandlers.delete(t)}static translateMouseEventLocationToCanvas(t,e){const n=e.getBoundingClientRect();return new h.a(t.clientX-n.left,t.clientY-n.top)}}class d{constructor(t){this.ctx=t,this.ctx.canvas.tabIndex=0,this.inputHandler=new l(document)}getScene(){return this.currentScene}setScene(t){if(this.currentScene===t)return!1;const e=this.currentScene;return this.currentScene=t,void 0!==e&&e.onSwitchedFromCurrent(),this.currentScene.onSwitchedToCurrent(),!0}start(){if(void 0===this.currentScene)throw new Error(\"Cannot start an undefined Scene.\");return void 0===this.gameEngine&&(this.gameEngine=new a(this)),this.gameEngine.start()}pause(){return void 0!==this.gameEngine&&this.gameEngine.stop()}update(t){void 0!==this.currentScene&&this.currentScene.update(t)}render(){void 0!==this.currentScene&&(this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.currentScene.render(this.ctx))}}class f{constructor(t){this.game=t,this.layers=[],this.layersAreSorted=!1}addKeyHandler(t,e=!1){return e||(void 0===this.keyHandlers&&(this.keyHandlers=new Set),this.keyHandlers.add(t)),this.game.inputHandler.addKeyHandler(t)}removeKeyHandler(t){return void 0!==this.keyHandlers&&this.keyHandlers.delete(t),this.game.inputHandler.removeKeyHandler(t)}addEventHandler(t,e=!1){e||(void 0===this.eventHandlers&&(this.eventHandlers=new Set),this.eventHandlers.add(t)),this.game.inputHandler.addEventHandler(t)}removeEventHandler(t){void 0!==this.eventHandlers&&this.eventHandlers.delete(t),this.game.inputHandler.removeEventHandler(t)}onSwitchedToCurrent(){}onSwitchedFromCurrent(){void 0!==this.keyHandlers&&(this.keyHandlers.forEach(t=>{this.game.inputHandler.removeKeyHandler(t)}),this.keyHandlers.clear()),void 0!==this.eventHandlers&&this.eventHandlers.forEach(t=>{this.game.inputHandler.removeEventHandler(t)})}getGame(){return this.game}addLayer(t){const e=this.layers.length!==this.layers.push(t);return e&&(this.layersAreSorted=!1),e}containsLayer(t){return this.layers.indexOf(t)>=0}removeLayer(t){const e=this.layers.indexOf(t);return!(e<0)&&(this.layers.splice(e,1),!0)}removeLayers(){this.layers.length=0}sortLayers(){return this.layersAreSorted||(this.layers.sort((t,e)=>t.getZOrder()-e.getZOrder()),this.layersAreSorted=!0),this.layers}update(t){this.layers.forEach(e=>e.update(t))}render(t){this.sortLayers().forEach(e=>e.render(t))}}class g extends f{constructor(t){super(t),this.inputUsername=document.createElement(\"input\"),this.inputUsername.type=\"text\",this.inputUsername.placeholder=\"Username\",this.inputUsername.className=\"on-canvas\",this.inputUsername.style.top=\"30%\",this.inputUsername.style.left=\"50%\",this.inputUsername.style.transform=\"translate(-50%, -50%)\",this.btnLogin=document.createElement(\"button\"),this.btnLogin.innerHTML=\"Login\",this.btnLogin.className=\"on-canvas unfocusable\",this.btnLogin.style.top=\"40%\",this.btnLogin.style.left=\"50%\",this.btnLogin.style.transform=\"translate(-112%, -50%)\",this.btnLogin.addEventListener(\"click\",this.login.bind(this)),this.btnHelp=document.createElement(\"button\"),this.btnHelp.innerHTML=\"Help\",this.btnHelp.className=\"on-canvas unfocusable\",this.btnHelp.style.top=\"40%\",this.btnHelp.style.left=\"50%\",this.btnHelp.style.transform=\"translate(12%, -50%)\",this.btnHelp.addEventListener(\"click\",this.showHelp.bind(this))}login(){this.inputUsername.value.length<1||null===this.inputUsername.value.match(/^[a-zA-Z0-9]*$/g)?alert(\"Username must be alphanumeric with no spaces.\"):this.getGame().tryLogin(this.inputUsername.value)}showHelp(){console.log(`Clicked '${this.btnHelp.innerText}'`)}addInputHandlers(){this.addEventHandler(new u(\"focus\",()=>this.inputUsername.focus())),this.addEventHandler(new u(\"click\",()=>this.inputUsername.focus())),this.addKeyHandler(new c(this.login.bind(this),(t,e)=>\"Enter\"===t&&e))}onSwitchedToCurrent(){super.onSwitchedToCurrent(),this.addInputHandlers();const t=k.getDOMContainer();t.appendChild(this.inputUsername),t.appendChild(this.btnLogin),t.appendChild(this.btnHelp),this.inputUsername.focus()}onSwitchedFromCurrent(){super.onSwitchedFromCurrent();const t=k.getDOMContainer();t.removeChild(this.inputUsername),t.removeChild(this.btnLogin),t.removeChild(this.btnHelp)}getGame(){return super.getGame()}render(t){t.drawImage(s.IMAGE_BACKGROUND,0,0),super.render(t)}}class p{constructor(t,e=h.a.ZERO){this.uid=t,this.locationListeners=new Set,this.location=e,this.velocity=h.a.ZERO}getUID(){return this.uid}getLocation(){return this.location}setLocation(t){return!this.location.equals(t)&&(this.location=t,this.locationListeners.forEach(e=>e(t)),!0)}translate(t){this.setLocation(this.location.addVector(t))}addLocationListener(t){return this.locationListeners.size!==this.locationListeners.add(t).size}containsLocationListener(t){return this.locationListeners.has(t)}removeLocationListener(t){return this.locationListeners.delete(t)}getVelocity(){return this.velocity}setVelocity(t){return this.velocity!==t&&(this.velocity=t,!0)}update(t){this.location=this.location.addVector(this.velocity.multiplyScalar(t))}}class E extends p{constructor(t,e,n=h.a.ZERO){super(t,n),this.image=e}getImage(){return this.image}render(t){const e=this.getLocation();t.drawImage(this.image,e.x-.5*this.image.width,e.y-.5*this.image.height)}}class y extends E{constructor(t,e,n,r){super(t,n),this.name=e,this.lives=r,this.livesListeners=new Set}getName(){return this.name}getLives(){return this.lives}setLives(t){this.lives=t,this.livesListeners.forEach(e=>e(t))}addLivesListener(t){return this.livesListeners.size!==this.livesListeners.add(t).size}containsLivesListener(t){return this.livesListeners.has(t)}removeLivesListener(t){return this.livesListeners.delete(t)}}var v=n(6),m=n(5),w=n(1),I=n(0);class R extends w.a{constructor(t){super(),this.BINARY_SIZE=1,this.angle=\"number\"==typeof t?t:t.readUInt8()}write(t){t.writeUInt8(this.angle)}getOPCode(){return I.b.MOVE_REQUEST}getEventSize(){return this.BINARY_SIZE}}class S extends w.a{getEventSize(){return S.BINARY_SIZE}getOPCode(){return I.b.END_MOVE}write(t){}}S.BINARY_SIZE=0;class L{constructor(t=0){this.objects=new Map,this.zOrder=t}getZOrder(){return this.zOrder}setZOrder(t){this.zOrder=t}getObject(t){return this.objects.get(t)}containsObject(t){return void 0!==this.objects.get(t)}setObject(t,e){return this.objects.size!==this.objects.set(t,e).size}removeObject(t){return this.objects.delete(t)}removeAllEntities(){this.objects.clear()}forEachEntity(t){this.objects.forEach(t)}someEntity(t){const e=this.objects.entries();let n;for(;(n=e.next())&&!n.done;)if(t(n.value[1],n.value[0]))return!0;return!1}update(t){this.objects.forEach(e=>e.update(t))}render(t){this.objects.forEach(e=>e.render(t))}}class b{constructor(t,e,n){this.topLeft=t,this.size=new h.a(e,n)}getMinX(){return this.topLeft.x}getCenterX(){return this.getLocation().x}getMaxX(){return this.getMinX()+this.size.x}getMinY(){return this.topLeft.y}getCenterY(){return this.getLocation().y}getMaxY(){return this.getMinY()+this.size.y}getTopLeft(){return this.topLeft}getLocation(){return void 0===this.center&&(this.center=this.topLeft.add(.5*this.size.x,.5*this.size.y)),this.center}getBottomRight(){return null==this.bottomRight&&(this.bottomRight=this.topLeft.addVector(this.size)),this.bottomRight}isEmpty(){return this.size.x<=0||this.size.y<=0}getVertices(){const t=this.getTopLeft(),e=this.getBottomRight();return[t,new h.a(e.x,t.y),e,new h.a(t.x,e.y)]}containsPoint(t){const e=this.getMinX(),n=this.getMinY();return t.x>=e&&t.y>=n&&t.x<e+this.size.x&&t.y<n+this.size.y}getArea(){return this.size.x*this.size.y}getBounds(){return this}containsRectangle(t){const e=t.getMinX(),n=t.getMinY(),r=t.size.x,i=t.size.y;if(r<=0||i<=0||this.isEmpty())return!1;const s=this.getMinX(),o=this.getMinY();return e>=s&&n>=o&&e+r<=s+this.size.x&&n+i<=o+this.size.y}intersects(t){const e=t.getMinX(),n=t.getMinY(),r=t.size.x,i=t.size.y;if(t.isEmpty()||this.isEmpty())return!1;const s=this.getMinX(),o=this.getMinY();return e+r>s&&n+i>o&&e<s+this.size.x&&n<o+this.size.y}render(t,e=!1){const n=this.topLeft;e?t.fillRect(n.x,n.y,this.size.x,this.size.y):t.strokeRect(n.x,n.y,this.size.x,this.size.y)}}class A extends L{constructor(t=1){super(t),this.icePlatformBounds=new b(new h.a(28,30),746,424)}getIcePlatformBounds(){return this.icePlatformBounds}render(t){t.drawImage(s.IMAGE_BACKGROUND,0,0),super.render(t)}}class _{static containsPoint(t,e,n=h.a.ZERO){e=e.addVector(n);const r=t.getBoundingClientRect(),i=r.top,s=r.bottom;if(i>e.y||e.y>s)return!1;const o=r.left,a=r.right;return o<=e.x&&e.x<=a}}class O extends L{constructor(t,e=1){super(e),this.canvas=t,this.btnLogout=document.createElement(\"button\"),this.btnLogout.className=\"on-canvas unfocusable\",this.btnLogout.innerHTML=\"Logout\",this.btnLogout.style.top=\"0%\",this.btnLogout.style.left=\"100%\",this.btnLogout.style.transform=\"translate(-100%, 0%)\",this.chatBox=document.createElement(\"textarea\"),this.chatBox.className=\"on-canvas unfocusable\",this.chatBox.id=\"chatbox\",this.chatBox.style.padding=\"0\",this.chatBox.style.margin=\"0\",this.chatBox.style.top=\"0\",this.chatBox.style.left=\"50%\",this.chatBox.style.width=\"65%\",this.chatBox.style.height=\"25%\",this.chatBox.style.transform=\"translate(-50%, 0%)\",this.chatBox.style.overflow=\"hidden\",this.chatBox.disabled=!0,this.chatBox.readOnly=!0,this.chatInputBox=document.createElement(\"input\"),this.chatInputBox.className=\"on-canvas unfocusable\",this.chatInputBox.id=\"chat-input\",this.chatInputBox.style.padding=\"0\",this.chatInputBox.style.margin=\"0\",this.chatInputBox.style.top=\"25%\",this.chatInputBox.style.left=\"50%\",this.chatInputBox.style.width=\"65%\",this.chatInputBox.style.transform=\"translate(-50%, 0%)\",this.chatInputBox.disabled=!0,this.chatInputBox.readOnly=!0,this.domElements=new Set([this.btnLogout,this.chatBox,this.chatInputBox])}findClickedDOMElements(t,e){const n=[],r=this.canvas.getBoundingClientRect(),i=new h.a(r.left,r.top);for(const r of this.domElements)_.containsPoint(r,t,i)&&e&&e(r)&&n.push(r);return n}findClickedDOMElementNotChatRelated(t){return this.findClickedDOMElements(t,t=>t!==this.chatInputBox&&t!==this.chatBox)}addLogoutClickListener(t){this.btnLogout.addEventListener(\"click\",t.bind(this))}addChatMessage(t){this.chatBox.value+=`${t}\\n`,this.chatBox.scrollTop=this.chatBox.scrollHeight-this.chatBox.clientHeight}setChatInputText(t){this.chatInputBox.value=t}appendToChatInputText(t){this.chatInputBox.value+=t}getChatInputText(){return this.chatInputBox.value}clearChatInputText(){this.chatInputBox.value=\"\"}getDOMElements(){return this.domElements}getChatbox(){return this.chatBox}getChatInputBox(){return this.chatInputBox}}class C{constructor(t,e,n=h.a.ZERO){this.renderedInfo=t,this.fontColor=e,this.location=n}getFontColor(){return this.fontColor}setFontColor(t){return t!==this.fontColor&&(this.fontColor=t,!0)}getLocation(){return this.location}setLocation(t){return!this.location.equals(t)&&(this.location=t,!0)}translate(t){this.setLocation(this.location.addVector(t))}getRenderingInfo(){return this.renderedInfo}setRenderingInfo(t){this.renderedInfo=t}update(t){}render(t){t.font=C.defaultFont,t.fillStyle=this.fontColor,i.fillTextMultiline(t,this.renderedInfo,this.location.x,this.location.y,14)}}C.DEFAULT_FONT_COLOR=\"#FF0000\",C.LOCAL_PLAYER_FONT_COLOR=\"#db32db\",C.defaultFont=\"14px Arial\";class T extends L{constructor(t,e=1){super(e),this.timeRenderLocation=t,this.isRoundCountingDown=!1}setRoundTimeRemaining(t){this.roundSecondsRemaining=t}setIsRoundCountingDown(t){this.isRoundCountingDown=t}getObject(t){return super.getObject(t)}setObject(t,e){return super.setObject(t,e)}render(t){super.render(t),void 0!==this.roundSecondsRemaining&&this.renderRoundTimeRemaining(t,this.roundSecondsRemaining)}renderRoundTimeRemaining(t,e){t.fillStyle=\"red\";t.font=\"14px Arial\";const n=Math.floor(e/60);e-=60*n;const r=Math.ceil(e).toString(),i=`${this.isRoundCountingDown?\"Round Start In\":\"Round Time Remaining\"}: ${n}:${1===r.length?\"0\"+r:r}`,s=t.measureText(i);t.fillText(i,this.timeRenderLocation.x-.5*s.width,this.timeRenderLocation.y+16.8)}}var x=n(9);class B extends f{constructor(t,e){super(t),this.playerID=e,this.gameplayLayer=new A,this.addLayer(this.gameplayLayer),this.domLayer=new O(this.game.ctx.canvas,3),this.addLayer(this.domLayer);const n=new h.a(.5*this.game.ctx.canvas.width,.3*this.game.ctx.canvas.height);this.infoLayer=new T(n,2),this.addLayer(this.infoLayer),this.domLayer.addLogoutClickListener(()=>this.getGame().logout()),this.game.inputHandler.addEventHandler(this.createMouseEventListener()),this.networkEventFunctionMap=new Map,this.networkEventFunctionMap.set(I.b.PING,this.onPingEvent.bind(this)),this.networkEventFunctionMap.set(I.b.NEW_OBJECT,this.onNewObjectEvent.bind(this)),this.networkEventFunctionMap.set(I.b.NEW_PLAYER,this.onNewPlayerEvent.bind(this)),this.networkEventFunctionMap.set(I.b.OBJECT_MOVED,this.onObjectMovedEvent.bind(this)),this.networkEventFunctionMap.set(I.b.PLAYER_LIVES_CHANGED,this.onPlayerLivesChangedEvent.bind(this)),this.networkEventFunctionMap.set(I.b.PLAYER_LOGGED_OUT,this.onPlayerLoggedOutEvent.bind(this)),this.networkEventFunctionMap.set(I.b.CHAT_RECEIVED,this.onChatReceivedEvent.bind(this)),this.networkEventFunctionMap.set(I.b.ROUND_STARTED,this.onRoundStartedEvent.bind(this)),this.networkEventFunctionMap.set(I.b.ROUND_WINNERS,this.onRoundWinnersEvent.bind(this)),this.networkEventFunctionMap.set(I.b.ROUND_START_COUNTDOWN,this.onRoundStartCountdownEvent.bind(this));const r=this.getGame().getConnection();if(void 0===r)throw new Error(\"The Game's connection should not be null.\");this.connection=r,this.connection.addDataReceivedListener(t=>t.getEvents().forEach(this.handleNetworkEvent.bind(this)))}handleNetworkEvent(t){const e=this.networkEventFunctionMap.get(t.getOPCode());void 0!==e&&e(t)}createMouseEventListener(){return new u(\"mousedown\",t=>this.requestProjectile(t))}requestProjectile(t){const e=l.translateMouseEventLocationToCanvas(t,this.game.ctx.canvas);0==this.domLayer.findClickedDOMElementNotChatRelated(e).length&&this.connection.enqueueEvent(new x.a(e.x,e.y))}onPingEvent(t){this.connection.enqueueEvent(new m.a)}onNewObjectEvent(t){const e=new E(t.id,s.getImageByID(t.type),t.location);this.gameplayLayer.setObject(t.id,e)}onNewPlayerEvent(t){const e=new y(t.playerID,t.username,s.getImageByID(t.type),t.lives);this.gameplayLayer.setObject(t.playerID,e);const n=t.playerID===this.playerID?C.LOCAL_PLAYER_FONT_COLOR:C.DEFAULT_FONT_COLOR,r=new C(`${e.getName()}\\nLives:${e.getLives()}`,n);this.infoLayer.setObject(t.playerID,r)}onPlayerLoggedOutEvent(t){this.gameplayLayer.removeObject(t.playerID),this.infoLayer.removeObject(t.playerID)}onChatReceivedEvent(t){const e=t.chatMessage;this.domLayer.addChatMessage(e)}onObjectMovedEvent(t){let e=this.gameplayLayer.getObject(t.id);if(void 0!==e){const n=this.gameplayLayer.getIcePlatformBounds().getTopLeft(),r=t.location.addVector(n);e.setLocation(r),e instanceof y&&this.updatePlayerInfoPane(e)}}updatePlayerInfoPane(t){const e=this.infoLayer.getObject(t.getUID()),n=t.getLocation().subtract(0,t.getImage().height);e.setLocation(n)}onPlayerLivesChangedEvent(t){const e=this.gameplayLayer.getObject(t.playerID);void 0!==e&&(e.setLives(t.lives),0===e.getLives()&&(this.gameplayLayer.removeObject(t.playerID),this.infoLayer.removeObject(t.playerID)))}onRoundStartedEvent(t){this.roundSecondsRemaining=t.timeMilliseconds/1e3,this.infoLayer.setIsRoundCountingDown(!1)}onRoundWinnersEvent(t){const e=[];for(const n of t.winnerIDs){const t=this.gameplayLayer.getObject(n);t instanceof y&&e.push(t.getName())}console.log(`Round Winner(s): ${e.join(\", \")}`)}onRoundStartCountdownEvent(t){this.roundSecondsRemaining=t.timeMilliseconds/1e3,this.infoLayer.setIsRoundCountingDown(!0)}createChatKeyHandler(){return new c(t=>{null!==t.match(/^[ a-zA-Z0-9,'\"!?._+=@#$%^&*()`~\\/\\-]$/g)?this.domLayer.appendToChatInputText(t):this.domLayer.getChatInputText().length>0&&(\"Backspace\"===t?this.domLayer.setChatInputText(this.domLayer.getChatInputText().slice(0,-1)):\"Enter\"===t&&(this.connection.enqueueEvent(new v.b(this.domLayer.getChatInputText())),this.domLayer.clearChatInputText()))},(t,e)=>e,!0)}sendCurrentMovement(){const t=this.getMovementAngle();t!==this.previousAngle&&(void 0!==t?this.connection.enqueueEvent(new R(t)):this.connection.enqueueEvent(new S),this.previousAngle=t)}getMovementAngle(){const t=this.getGame().inputHandler,e=t.isKeyDown(\"ArrowLeft\"),n=t.isKeyDown(\"ArrowRight\"),r=t.isKeyDown(\"ArrowUp\"),i=t.isKeyDown(\"ArrowDown\");let s=void 0,o=void 0;return e&&!n?o=192:!e&&n&&(o=64),r&&!i?s=128:!r&&i&&(s=e?255:0),void 0===o?s:void 0===s?o:Math.round(.5*(o+s))}attachDOMElements(){const t=k.getDOMContainer();this.domLayer.getDOMElements().forEach(e=>t.appendChild(e))}removeDOMElements(){const t=k.getDOMContainer();this.domLayer.getDOMElements().forEach(e=>t.removeChild(e))}onSwitchedToCurrent(){super.onSwitchedToCurrent(),this.attachDOMElements(),this.addKeyHandler(this.createChatKeyHandler())}onSwitchedFromCurrent(){super.onSwitchedFromCurrent(),this.removeDOMElements()}getGame(){return super.getGame()}update(t){super.update(t),this.updateRoundTimeRemaining(t),this.infoLayer.setRoundTimeRemaining(this.roundSecondsRemaining),o.a.now()-this.connection.getLastSendTime()>=B.PING_TIMEOUT&&this.connection.enqueueEvent(new m.a),this.sendCurrentMovement()}updateRoundTimeRemaining(t){this.gameplayLayer.someEntity(t=>t instanceof y&&t.getUID()!==this.playerID)?void 0!==this.roundSecondsRemaining&&(this.roundSecondsRemaining=Math.max(0,this.roundSecondsRemaining-t)):this.roundSecondsRemaining=void 0}}B.PING_TIMEOUT=5;var M=n(10);class N extends w.a{constructor(){super(...arguments),this.BINARY_SIZE=0}getEventSize(){return this.BINARY_SIZE}getOPCode(){return I.b.LOGOUT}write(t){}}var D=n(3);class P extends w.a{constructor(t,e){if(super(),t instanceof D.a)this.clientVersion=t.readInt8(),this.playerName=t.readString();else{if(void 0===e)throw new Error(`Malformed constructor:\\n${t}\\n${e}`);this.clientVersion=t,this.playerName=e}this.BINARY_SIZE=1+D.a.getStringWriteSize(this.playerName)}getEventSize(){return this.BINARY_SIZE}getOPCode(){return I.b.LOGIN}write(t){t.writeInt8(this.clientVersion),t.writeString(this.playerName)}}var U=n(7),Y=n(8);class k extends d{tryLogin(t){if(this.isConnectionOpenOrConnecting())return;this.connection=new M.a(k.SERVER_ADDRESS);const e=this.connection,n=t=>{clearTimeout(r),e.removeErrorListener(i);const s=t.getEvents(),o=s.find(t=>t instanceof Y.a);if(void 0!==o)e.removeDataReceivedListener(n),this.onLoginSucceeded(o.playerID);else{e.close();const t=s.find(t=>t instanceof U.a);alert(void 0!==t&&void 0!==t.message?t.message:\"An unknown error has occurred.\")}},r=setTimeout(()=>{alert(\"Connection timed out.\")},k.LOGIN_TIMEOUT);this.connection.addDataReceivedListener(n),this.connection.addCloseListener(()=>{clearTimeout(r),this.currentScene instanceof B&&this.showHomeScene()}),this.connection.addOnOpenedListener(()=>e.send(new P(k.CLIENT_VERSION,t)));const i=()=>{e.removeErrorListener(i),alert(\"Connection error!\")};this.connection.addErrorListener(i)}isConnectionOpenOrConnecting(){if(void 0!==this.connection){const t=this.connection.getState();return t===WebSocket.OPEN||t===WebSocket.CONNECTING}return!1}logout(){void 0!==this.connection&&(this.connection.send(new N),this.showHomeScene(),this.connection.close(),this.connection=void 0)}onLoginSucceeded(t){this.playerID=t,this.showGameScene()}getConnection(){return this.connection}showHomeScene(){if(void 0===this.homeScene)this.homeScene=new g(this);else if(this.currentScene===this.homeScene)return!1;return this.setScene(this.homeScene),!0}showGameScene(){return!(void 0===this.playerID||this.currentScene instanceof B)&&(this.setScene(new B(this,this.playerID)),!0)}static getDOMContainer(){const t=document.getElementById(\"canvas-container\");if(null===t)throw new Error(\"Failed to get DOM element\");return t}update(t){super.update(t),void 0!==this.connection&&this.connection.isConnected()&&this.connection.flushEventQueue()}}k.CLIENT_VERSION=110,k.LOGIN_TIMEOUT=3e3,k.runLocal=\"file:\"===location.protocol,k.serverAddress=k.runLocal?\"localhost\":\"avahe.tech\",k.SERVER_ADDRESS=\"ws://\"+k.serverAddress+\":2345\",console.log(\"[IcePush] Loading assets...\");const H=s.load();console.log(\"[IcePush] Loading canvas...\");const G=document.getElementById(\"canvas\"),z=i.getContext(G);H.then(()=>{console.log(\"[IcePush] Assets loaded.\");const t=new k(z);t.showHomeScene(),t.start(),console.log(\"[IcePush] Game Started.\")}),H.catch(t=>{console.error(`Failed to load assets!\\n${t}`)})}]);","extractedComments":[]}